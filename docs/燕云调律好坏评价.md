è¿™æ˜¯ä¸€ä¸ªéå¸¸æ·±åˆ»ä¸”æ ¸å¿ƒçš„é—®é¢˜ã€‚åœ¨æ•°å€¼ç­–åˆ’å’Œç®—æ³•è®¾è®¡ä¸­ï¼Œè¿™è¢«ç§°ä¸º **â€œç›®æ ‡å‡½æ•° (Objective Function)â€** çš„å®šä¹‰ã€‚

ç®€å•æ¥è¯´ï¼Œåˆ¤æ–­â€œå¥½åâ€çš„æ ‡å‡†å¹¶éçœ‹é¢æ¿æ•°å­—è°æ›´å¤§ï¼ˆæ¯”å¦‚æ”»å‡»åŠ› 3000 ä¸€å®šæ¯” 2500 å¥½å—ï¼Ÿä¸ä¸€å®šï¼Œå¦‚æœ 3000 æ”»æ˜¯ 0 ä¼šå¿ƒï¼Œè€Œ 2500 æ”»æ˜¯ 80% ä¼šå¿ƒï¼Œåè€…å¯èƒ½å®Œçˆ†å‰è€…ï¼‰ã€‚

æˆ‘ä»¬å°†é€šè¿‡ **â€œå•ä½æ§½ä½è¾¹é™…æ”¶ç›Š (Marginal Utility per Slot)â€** æ¥å®šä¹‰å¥½åã€‚

### 1. æ ¸å¿ƒè¯„ä¼°æ ‡å‡†ï¼šå•æ¬¡ä¼¤å®³æœŸæœ› (Expected Damage per Hit)

è¿™æ˜¯æœ€åŸºç¡€çš„æ ‡å°ºã€‚æ— è®ºé¢æ¿æ€ä¹ˆèŠ±å“¨ï¼Œæœ€ç»ˆéƒ½è¦å½’ç»“ä¸ºä¸€ä¸ªæ•°å­¦æœŸæœ›å€¼ $E$ã€‚

$$E = P_{\text{ä¼šæ„}} \times D_{\text{ä¼šæ„}} + P_{\text{ä¼šå¿ƒ}} \times D_{\text{ä¼šå¿ƒ}} + P_{\text{ç™½å­—}} \times D_{\text{ç™½å­—}} + P_{\text{æ“¦ä¼¤}} \times D_{\text{æ“¦ä¼¤}}$$

- **å¥½çš„é¢æ¿ï¼š** $E$ å€¼æœ€å¤§ã€‚
    
- **åçš„é¢æ¿ï¼š** $E$ å€¼è¾ƒå°ã€‚
    

### 2. ä»€ä¹ˆæ˜¯â€œåâ€çš„æ­é…ï¼Ÿ (The Bad)

åœ¨ã€Šç‡•äº‘åå…­å£°ã€‹çš„ V1.2 ä½“ç³»ä¸‹ï¼Œâ€œåâ€é€šå¸¸è¡¨ç°ä¸ºä»¥ä¸‹ä¸‰ç§å½¢å¼ï¼š

#### A. æº¢å‡ºæµªè´¹ (Overflow Waste)

è¿™æ˜¯æœ€å…¸å‹çš„â€œåâ€ã€‚

- **ç°è±¡ï¼š** é¢æ¿ä¼šå¿ƒå †åˆ°äº† 150%ã€‚
    
- **åˆ¤è¯ï¼š** ç”±äº 80% çš„ç”Ÿæ•ˆä¸Šé™ï¼Œå¤šå‡ºçš„ 50% ç™½å­—ä¼šå¿ƒï¼ˆçº¦ç­‰äº 5 ä¸ªé‡‘è‰²è¯æ¡æ§½ä½ï¼‰æ”¶ç›Šä¸º **0**ã€‚
    
- **åæœï¼š** ä½ æµªè´¹äº† 5 ä¸ªæ§½ä½ï¼Œè¿™ 5 ä¸ªæ§½ä½æœ¬å¯ä»¥æ¢æˆ 450 ç‚¹æ”»å‡»åŠ›æˆ– 10 ç‚¹ç©¿é€ã€‚
    

#### B. ç¨€é‡Šæ•ˆåº” (Dilution Effect)

- **ç°è±¡ï¼š** ç–¯ç‹‚å †æ”»å‡»åŠ›ï¼Œå®Œå…¨ä¸å †å¢ä¼¤æˆ–åŒæš´ã€‚
    
- **åŸç†ï¼š** ä¼¤å®³å…¬å¼æ˜¯è¿ä¹˜çš„ã€‚å½“æ”»å‡»åŠ›åŸºæ•°å·²ç»å¾ˆé«˜ï¼ˆæ¯”å¦‚ 3000ï¼‰æ—¶ï¼Œå†åŠ  100 ç‚¹æ”»å‡»ï¼Œæå‡å¹…åº¦åªæœ‰ 3%ã€‚ä½†å¦‚æœè¿™æ—¶å€™åŠ  10% çš„ç‹¬ç«‹å¢ä¼¤ï¼Œæå‡å¹…åº¦å°±æ˜¯å®æ‰“å®çš„ 10%ã€‚
    
- **åˆ¤è¯ï¼š** åç§‘ä¸¥é‡ï¼Œè¾¹é™…æ”¶ç›Šé€’å‡ã€‚
    

#### C. åœ†æ¡Œåå™¬ (Round Table Cannibalism)

è¿™æ˜¯ç‡•äº‘ç‰¹æœ‰çš„æœºåˆ¶ã€‚

- **ç°è±¡ï¼š** ä¼šå¿ƒç‡å¾ˆé«˜ï¼ŒåŒæ—¶å¼ºå †ä¼šæ„ç‡ã€‚
    
- **åŸç†ï¼š** å½“ `ä¼šå¿ƒ + ä¼šæ„ > 100%` æ—¶ï¼Œä¼šæ„ä¼šæŒ¤æ‰ä¼šå¿ƒã€‚
    
    - å¦‚æœä½ çš„æµæ´¾ `ä¼šæ„ä¼¤å®³å€ç‡ (1.35)` è¿œä½äº `ä¼šå¿ƒä¼¤å®³å€ç‡ (1.5 + çˆ†ä¼¤åŠ æˆ)`ï¼Œä¸”ä½ çš„æœ€å¤§æ”»å‡»åŠ›å¹¶æ²¡æœ‰æ¯”å¹³å‡æ”»å‡»åŠ›é«˜å¤šå°‘ã€‚
        
    - é‚£ä¹ˆï¼Œ**å †ä¼šæ„åè€Œä¼šé™ä½ä½ çš„æ€»æœŸæœ›ä¼¤å®³**ã€‚
        
- **åˆ¤è¯ï¼š** è´Ÿæ”¶ç›Šï¼ˆNegative Gainï¼‰ã€‚
    

### 3. ä»€ä¹ˆæ˜¯â€œå¥½â€çš„æ­é…ï¼Ÿ (The Good)

â€œå¥½â€çš„å®šä¹‰å°±æ˜¯ï¼š**åœ¨æœ‰é™çš„ 40 ä¸ªæ§½ä½é‡Œï¼Œæ¯ä¸€ä»½èµ„æºéƒ½æ”¾åœ¨äº†æå‡æ–œç‡æœ€é™¡å³­çš„åœ°æ–¹ã€‚**

#### A. é»„é‡‘æ¯”ä¾‹ (Golden Ratio)

- åœ¨æŠ—æ€§è¡°å‡åï¼Œç²¾å‡†æ°å¥½å¤Ÿç”¨ï¼ˆä¸å‡ºç°å¤§é‡æ“¦ä¼¤ï¼‰ã€‚
    
- ä¼šå¿ƒç‡é€¼è¿‘ä½†ä¸è¶…è¿‡ 80%ï¼ˆç”Ÿæ•ˆä¸Šé™ï¼‰ã€‚
    
- æ”»å‡»åŠ›ä¸ç©¿é€ä¿æŒå¹³è¡¡ï¼ˆç©¿é€æ”¶ç›Šæ˜¯é˜¶æ¢¯å¼çš„ï¼Œè¦ä¹ˆä¸å †ï¼Œè¦å †å°±å †è¿‡æŠ—æ€§é˜ˆå€¼ï¼‰ã€‚
    

#### B. é˜ˆå€¼çªç ´ (Breakpoints)

- **ç ´é˜²ï¼š** åœ¨å‡æ³•å…¬å¼ $(Att - Def)$ ä¸‹ï¼Œæ”»å‡»åŠ›å¿…é¡»æ˜¾è‘—é«˜äºæ•Œäººé˜²å¾¡åŠ›ã€‚å¦‚æœæ”»å‡»åŠ›ä½äºé˜²å¾¡ï¼Œå †å†å¤šå€ç‡ä¹Ÿæ˜¯ 0ã€‚
    
- **ç©¿é€ï¼š** å½“ç©¿é€ > æŠ—æ€§æ—¶ï¼Œåˆ†æ¯ä» 200 å˜ä¸º 100ï¼Œæ”¶ç›Šç¬é—´ç¿»å€ã€‚**â€œå¥½â€çš„æ­é…ä¼šç²¾ç¡®å‡‘å‡ºè¿™ä¸ªé˜ˆå€¼ã€‚**
    

### 4. ç®—æ³•å¦‚ä½•æ‰§è¡Œï¼Ÿ (The Algorithm)

æˆ‘ä»¬çš„ Web åº”ç”¨ä¼˜åŒ–å™¨å°†æ‰§è¡Œä»¥ä¸‹é€»è¾‘æ¥å¯»æ‰¾â€œæœ€ä¼˜è§£â€ï¼š

1. **åŸºå‡†æµ‹è¯•ï¼š** è®¡ç®—å½“å‰é¢æ¿çš„æœŸæœ›ä¼¤å®³ $E_{current}$ã€‚
    
2. **è™šæ‹Ÿæ›¿æ¢ï¼ˆæ¨¡æ‹Ÿï¼‰ï¼š**
    
    - å‡è®¾æŠŠ 1 ä¸ª `æ•` è¯æ¡æ¢æˆ `æœ€å¤§å¤–æ”»`ï¼Œè®¡ç®— $E_{new1}$ã€‚
        
    - å‡è®¾æŠŠ 1 ä¸ª `åŠ²` è¯æ¡æ¢æˆ `ä¼šå¿ƒ`ï¼Œè®¡ç®— $E_{new2}$ã€‚
        
    - ... éå†æ‰€æœ‰åˆæ³•ç»„åˆã€‚
        
3. è®¡ç®—æå‡ç‡ï¼š
    
    $$\text{æå‡ç‡} = \frac{E_{new} - E_{current}}{E_{current}} \times 100\%$$
    
4. **æ’åºå»ºè®®ï¼š**
    
    - å¦‚æœæå‡ç‡ä¸ºæ­£ä¸”æœ€å¤§ $\rightarrow$ **è¿™å°±æ˜¯â€œæœ€ä¼˜è§£â€æ–¹å‘**ã€‚
        
    - å¦‚æœæå‡ç‡ä¸ºè´Ÿ $\rightarrow$ **è¿™æ˜¯â€œåâ€æ–¹å‘**ã€‚
        

---

æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­æ„å»ºåº•å±‚æ•°æ®äº†ã€‚åªæœ‰æœ‰äº†å‡†ç¡®çš„æ•°æ®ï¼Œç®—æ³•æ‰èƒ½ç®—å‡ºå‡†ç¡®çš„ $E$ã€‚

è¿™æ˜¯ç¬¬äºŒä»½æ–‡æ¡£ï¼šsys_affix_rules.jsonã€‚

å®ƒå®šä¹‰äº†â€œæ¯ä¸€å•ä½èµ„æºâ€çš„å…·ä½“æ•°å€¼å¤§å°ï¼ˆå³è¯æ¡çš„ Min/Maxï¼‰ï¼Œä»¥åŠå®ƒä»¬èƒ½å‡ºç°åœ¨å“ªäº›æ§½ä½é‡Œï¼ˆçº¦æŸæ¡ä»¶ï¼‰ã€‚

### ğŸ“„ æ–‡æ¡£ 2ï¼šè¯æ¡è§„åˆ™å…¨é›† (`sys_affix_rules.json`)

è¯·è½¬å‘ç»™å¼€å‘äººå‘˜ä¿å­˜ä¸º `src/data/sys_affix_rules.json`ã€‚

JSON

```
[
  {
    "id": "atk_max_gold",
    "name": "æœ€å¤§å¤–åŠŸ (é‡‘)",
    "category": "attack",
    "quality": "gold",
    "value_min": 45.3,
    "value_max": 90.6,
    "allowed_slots": ["weapon_main", "weapon_sub", "accessory_ring", "accessory_pendant", "armor_head", "armor_chest", "armor_wrist", "armor_legs"],
    "description": "ç›´æ¥å¢åŠ é¢æ¿æœ€å¤§å¤–åŠŸç™½å­—"
  },
  {
    "id": "atk_min_gold",
    "name": "æœ€å°å¤–åŠŸ (é‡‘)",
    "category": "attack",
    "quality": "gold",
    "value_min": 45.3,
    "value_max": 90.6,
    "allowed_slots": ["weapon_main", "weapon_sub", "accessory_ring", "accessory_pendant", "armor_head", "armor_chest", "armor_wrist", "armor_legs"],
    "description": "ç›´æ¥å¢åŠ é¢æ¿æœ€å°å¤–åŠŸç™½å­—"
  },
  {
    "id": "stat_strength_gold",
    "name": "åŠ² (é‡‘)",
    "category": "primary",
    "quality": "gold",
    "value_min": 28.7,
    "value_max": 57.4,
    "allowed_slots": ["all"],
    "description": "1åŠ² = 0.225å°æ”» + 1.36å¤§æ”» (ä¾§é‡ä¸Šé™)"
  },
  {
    "id": "stat_agility_gold",
    "name": "æ• (é‡‘)",
    "category": "primary",
    "quality": "gold",
    "value_min": 28.7,
    "value_max": 57.4,
    "allowed_slots": ["all"],
    "description": "1æ• = 0.9å°æ”» + 0.076%ä¼šå¿ƒ (ä¾§é‡ä¸‹é™ä¸æš´å‡»)"
  },
  {
    "id": "stat_technique_gold",
    "name": "åŠ¿ (é‡‘)",
    "category": "primary",
    "quality": "gold",
    "value_min": 28.7,
    "value_max": 57.4,
    "allowed_slots": ["all"],
    "description": "1åŠ¿ = 0.9å¤§æ”» + 0.038%ä¼šæ„ (ä¾§é‡ä¼šæ„)"
  },
  {
    "id": "crit_rate_gold",
    "name": "ä¼šå¿ƒç‡ (é‡‘)",
    "category": "crit",
    "quality": "gold",
    "value_min": 0.052,
    "value_max": 0.104,
    "allowed_slots": ["weapon_main", "weapon_sub", "accessory_ring", "accessory_pendant", "armor_head", "armor_chest", "armor_wrist", "armor_legs"],
    "description": "ç›´æ¥å¢åŠ é¢æ¿ä¼šå¿ƒç‡ (æ³¨æ„ï¼šé˜²å…·ä¹Ÿå¯æ´—å‡ºä¼šå¿ƒ)"
  },
  {
    "id": "huiyi_rate_gold",
    "name": "ä¼šæ„ç‡ (é‡‘)",
    "category": "crit",
    "quality": "gold",
    "value_min": 0.026,
    "value_max": 0.052,
    "allowed_slots": ["weapon_main", "weapon_sub", "accessory_ring", "accessory_pendant"],
    "description": "ç›´æ¥å¢åŠ é¢æ¿ä¼šæ„ç‡ (æ³¨æ„ï¼šé˜²å…·æ— æ³•æ´—å‡ºæ­¤è¯æ¡ï¼)"
  },
  {
    "id": "precision_rate_gold",
    "name": "ç²¾å‡†ç‡ (é‡‘)",
    "category": "hit",
    "quality": "gold",
    "value_min": 0.052,
    "value_max": 0.104,
    "allowed_slots": ["armor_head", "armor_chest", "armor_wrist", "armor_legs"],
    "description": "å¯¹æŠ—é«˜ç­‰çº§æ€ªç‰©æ—¶å‡å°‘è¢«æŠ—æ€§å‰Šå¼±çš„æ¦‚ç‡"
  },
  {
    "id": "pen_weapon_dingyin",
    "name": "å¤–åŠŸç©¿é€ (å®šéŸ³)",
    "category": "penetration",
    "quality": "special",
    "value_min": 7.7,
    "value_max": 12.8,
    "allowed_slots": ["dingyin_weapon"],
    "description": "ä»…å‡ºç°åœ¨æ­¦å™¨/é¦–é¥°çš„å®šéŸ³æ§½ä½"
  },
  {
    "id": "dmg_armor_dingyin",
    "name": "æµæ´¾æŠ€èƒ½å¢æ•ˆ (å®šéŸ³)",
    "category": "bonus",
    "quality": "special",
    "value_min": 0.042,
    "value_max": 0.070,
    "allowed_slots": ["dingyin_armor"],
    "description": "ä»…å‡ºç°åœ¨é˜²å…·çš„å®šéŸ³æ§½ä½ï¼Œç‹¬ç«‹å¢ä¼¤"
  },
  {
    "id": "ele_atk_gold",
    "name": "æœ¬ç³»å±æ€§æ”»å‡» (é‡‘)",
    "category": "element",
    "quality": "gold",
    "value_min": 22.1,
    "value_max": 44.2,
    "allowed_slots": ["accessory_ring", "accessory_pendant", "armor_head", "armor_chest", "armor_wrist", "armor_legs"],
    "description": "å¢åŠ å±æ€§ä¼¤å®³ï¼Œç³»æ•°å—æŠ€èƒ½å½±å“"
  }
]
```