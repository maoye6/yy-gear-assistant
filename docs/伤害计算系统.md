# 燕云十六声 — 核心战斗数值体系设计文档 (V1.2 定稿)

版本： v1.2

日期： 2025-12-30

核心变更： 引入“直接暴击/会意”概念；修正抗性衰减公式；增加生效上限(Cap)逻辑；增加擦伤转化逻辑；细化增伤类型。

---

## 1. 属性分层定义 (Attribute Hierarchy)

为了准确计算，必须将属性分为三个层级：

### 1.1 白字属性 (Panel Stats)

- **定义：** 角色面板上显示的“总属性值”。
    
- **构成：** 五维转化 + 装备词条 + 调律 + 食物/Buff。
    
- **作用：** 作为抗性衰减计算的基础输入。
    

### 1.2 黄字属性 (Effective Stats)

- **定义：** 在同等级对抗中，经过抗性衰减和上限截断后，**实际生效**的基础概率。
    
- **特征：** 受“判定抗性”严重影响，且存在硬性上限（Cap）。
    

### 1.3 最终概率 (Final Probability)

- **定义：** 用于圆桌判定的最终数值。
    
- **公式：** $\text{最终概率} = \text{黄字属性} + \text{直接概率}$
    
- **特征：** “直接概率”（来自心法突破）无视抗性、无视上限，直接叠加。
    

---

## 2. 核心转化与抗性公式 (Core Formulas)

**判定抗性 (Resistance):**

- 当前满级（100级/十八级）抗性系数为 **85%** (0.85)。
    
- 这是一个分母参数，用于削减白字属性的收益。
    

### 2.1 精准率计算 (Precision)

精准率采用“基数保留”机制，只衰减溢出部分。

- **基础精准：** 65%
    
- **白字精准：** 面板显示值（例如 115%）
    
- **转化公式：**
    
    $$\text{黄字精准} = 65\% + \frac{\text{白字精准} - 65\%}{1 + \text{判定抗性}}$$
    
    _验证：$65\% + (115\%-65\%)/(1+0.85) = 92.0\%$_
    

### 2.2 会心/会意计算 (Crit & Intent)

这两项属性采用“全额衰减”机制，且存在生效上限。

|**属性**|**转化公式**|**生效上限 (Cap)**|**最终计算**|
|---|---|---|---|
|**会心**|$\text{黄字} = \frac{\text{白字会心}}{1 + \text{判定抗性}}$|**80%**|$\text{Min}(\text{黄字}, 80\%) + \text{直接会心}$|
|**会意**|$\text{黄字} = \frac{\text{白字会意}}{1 + \text{判定抗性}}$|**40%**|$\text{Min}(\text{黄字}, 40\%) + \text{直接会意}$|

验证会心：$132.2\% / 1.85 \approx 71.5\%$ (未超80%上限)

验证会意：$21.0\% / 1.85 \approx 11.3\%$ (未超40%上限)

---

## 3. 圆桌判定流程 (Round Table Logic)

攻击发生时，系统按照以下严格顺序进行判定：

### Step 1: 精准判定

产生一个 0~100% 的随机数 $R_1$。

- 若 $R_1 \le \text{黄字精准}$：**判定命中** $\rightarrow$ 进入 Step 2。
    
- 若 $R_1 > \text{黄字精准}$：**判定未命中** $\rightarrow$ 进入 Step 3。
    

### Step 2: 命中判定 (会心 vs 会意 vs 白字)

此处使用的是 **最终会心率** 和 **最终会意率**。

- **挤压规则 (The Squeeze)：**
    
    - 若 $\text{最终会心} + \text{最终会意} > 100\%$，会意优先挤压会心。
        
    - $\text{实际会意} = \text{最终会意}$
        
    - $\text{实际会心} = 100\% - \text{最终会意}$
        
- **判定结果优先级：**
    
    1. **会意** (Intent Hit): 造成最大攻伤害 + 35%加成。
        
    2. **会心** (Crit Hit): 造成随机攻伤害 + 50%加成。
        
    3. **白字** (Normal Hit): 造成随机攻伤害。
        

### Step 3: 未命中判定 (会意 vs 转化 vs 擦伤)

未精准命中时，**无法触发会心**，但仍可触发会意。

1. **判定会意：** 是否触发 **最终会意率**？
    
    - 是 $\rightarrow$ **会意伤害** (Intent Hit)。
        
    - 否 $\rightarrow$ 下一步。
        
2. **判定擦伤转化：** 是否触发 **擦伤转化率**？
    
    - 是 $\rightarrow$ **白字伤害** (Normal Hit)。
        
    - 否 $\rightarrow$ **擦伤** (Glancing Hit, 基于最小攻结算，系数通常为0.5)。
        

---

## 4. 伤害计算总公式 (Damage Pipeline)

$$\text{最终伤害} = \text{基底伤害} \times \text{类型修正} \times \text{穿透修正} \times \text{通用增伤} \times \text{独立增伤} \times \text{特定增伤}$$

### 4.1 基底伤害 (Base Damage)

$$\text{基底} = [(\text{攻击力} - \text{防御}) \times \text{技能倍率}] + \text{固伤} + \text{属伤}$$

- **攻击力取值：**
    
    - 会意：取 `Max_Atk`。
        
    - 擦伤：取 `Min_Atk`。
        
    - 其他：`Random(Min, Max)`。
        

### 4.2 类型修正 (Type Multiplier)

- **会意：** $1.35$ (基础) $+ \text{会意伤害加成}$
    
- **会心：** $1.50$ (基础) $+ \text{会心伤害加成}$
    
- **白字/转化：** $1.0$
    
- **擦伤：** $0.5$ (预估系数，待定)
    

### 4.3 增伤乘区细分

根据最新定义，我们将增伤区细化为：

- **A类 - 通用/状态增伤 (Additive Group 1):**
    
    - 气竭(10%)、易水歌、威猛歌等状态类增伤。
        
- **B类 - 武学增效 (Additive Group 2):**
    
    - $\text{全部武学增效} + \text{指定武器增效}$ (取最大值)。
        
    - _注意：此乘区对奇术、心法无效。_
        
- **C类 - 对象增伤 (Target Bonus):**
    
    - 首领增伤 (6.1%)。
        
- **D类 - 独立增伤 (Independent):**
    
    - 鼠鼠Q、防具定音等明确说明独立的词条。
        

---

## 5. 辅助数据参考 (Reference Data)

### 5.1 判定抗性表

|**等级段**|**称号**|**抗性值**|
|---|---|---|
|81-85|十二级·无为|15%|
|86-90|十三级·普观|30%|
|91-95|十四/十五级|45%|
|96-100|十六/十七级|65%|
|**100+**|**十八/十九级**|**85%**|

### 5.2 五维转化系数 (用于面板构建)

- **体:** $1 \to 60\text{血}$
    
- **御:** $1 \to 17\text{血} + 0.5\text{防}$
    
- **敏:** $1 \to 0.9\text{小攻} + 0.076\%\text{会心}$
    
- **势:** $1 \to 0.9\text{大攻} + 0.038\%\text{会意}$
    
- **劲:** $1 \to 0.225\text{小攻} + 1.36\text{大攻}$
    

---
